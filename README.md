# ComfyUI_SoX_Effects

This repository contains a collection of ComfyUI nodes for applying various audio effects using the SoX library. These nodes allow users to manipulate audio files within the ComfyUI framework, enhancing the capabilities of generative AI models for audio processing tasks.

<img src="example/SoxUtilMuxAudio5_1 Testing Workflow (0.1.1) 2026-01-30 14-22-10.png?raw">

## Effects supported (61)

## How the nodes work

Load-Audio ---> Sox-Effect-1 --- Sox-Effect-N ---> Sox-Apply ---> Save-Audio

Each socks effect node has an audio and sox-parameters input and an audio-out and sox-parameters output. These are essentially passthroughs where audio is not altered at each effect but passes through instead. On the other hand, sox-parameters for each effect stack up.

The audio is not processed until the **Sox-Apply** node is hit where all the prior stack of effects coming in on sox-parameters are finally applied in the same sequence as the workflow graph, to the audio coming in on its audio input.

Things are a little bit different for the Sox-Spectogram node, in that it will process a copy of the audio up to that point in the workflow and generate a histogram image. But it will pass the unaltered audio through to the next node, and it does not add its own parameters to the current sox-parameters stack and allows it to pass through unaltered.

So the first effects node takes incoming audio from a load-audio node and takes not incoming sox-parameters. The next effect node takes the last effects node's audio and sox-parameters as input and so on until a Sox-Apply node is used to add apply the workflows stack of effects to the audio and finally passes on the processed audion to something like a save-audio node.

## Menu Grouping of Effects

I mainly dove into the SoX rabbit hole to leverage SoX Effects for AI character voice post-processing. So a subset of Effects most likely used to perform voice alteration is listed under "Voice" all other effects are listed under "Effects," and Audio Utility nodes under "Utilities."

## Debugging Workflows

Wire dbg-text to a PreviewTextNode (I use GripTape's) to review sox-parameters generated by a node. Or use the added text-muxer to see how a workflow builds up the sox-parameters stack. This can be useful for debugging and understanding how effects are applied in sequence.

## Latest New Feature 2026-01-28

Added SoxUtilMuxAudio5-1
- A five-channel audio muxer with four audio mixing modes.
  - Mixing Modes...
    1. Average
      - Less sensitive to peaks; useful for smooth level detection.
    2. Linear Sum
      - Used when preserving transient detail and phase relationships is important. 
    3. RMS Power
      - Better reflects perceived loudness than peak levels.
      - Commonly used in level meters and dynamics processing.
    4. Max Amplitude
      - Used with true peak meters to catch intersample peaks that could distort in playback or conversion. 
    5. Auto-characterized tracks for rms_power and max_amplitude mixing modes (Standard, Sample_Accurate, Absonic). Tracks are processed differently based on characteristics to optimize mixing for each mode.

Requires Torch Audio.

Auto Volume Balance Detection for RMS Power and Max Amplitude mixing modes.

## Progress...

  - Total Nodes: 101
  - Nodes Tested: 11
  - Nodes Untested: 90

### Tested and Refined

SoxUtilSpectrogramNode, SoxUtilTextMux5Node, SoxUtilTextMux10Node
SoxUtilAudioMux5Node, SoxUtilAudioMuxPro5Node, SoxUtilAudioSplit5Node
SoxUtilAudioReportNode, SoxApplyEffectsNode, SoxFirNode, SoxVeDeepOldManNode
SoxVeGhostNode

#### Notable

SoxFirNode:
  - Added dropdown of 38 fir_coefficient room acoustics files.
    - Each fir_coefficient file contains the fir coefficients for an environment type or room, modifying audio sound with that rooms acoustics.

## Future work

Enable process_modes for node and do equivalent for SoX effect using torch-audio if possible.

## Help...

- Please report issues, suggest features, or ask questions on the GitHub repository.
- Join the discussion and share your experiences with the community.
- Contribute to the project by submitting pull requests or improving documentation.

